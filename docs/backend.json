{
  "entities": {
    "Announcement": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Announcement",
      "type": "object",
      "description": "Represents a school announcement.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the announcement."
        },
        "title": {
          "type": "string",
          "description": "Title of the announcement."
        },
        "date": {
          "type": "string",
          "description": "Date of the announcement.",
          "format": "date-time"
        },
        "shortDescription": {
          "type": "string",
          "description": "Short description or excerpt of the announcement."
        },
        "content": {
          "type": "string",
          "description": "Full content of the announcement."
        },
        "authorId": {
          "type": "string",
          "description": "The UID of the teacher who created the announcement."
        }
      },
      "required": [
        "id",
        "title",
        "date",
        "shortDescription",
        "content",
        "authorId"
      ]
    },
    "Event": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Event",
      "type": "object",
      "description": "Represents a school event.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the event."
        },
        "title": {
          "type": "string",
          "description": "Title of the event."
        },
        "date": {
          "type": "string",
          "description": "Date and time of the event.",
          "format": "date-time"
        },
        "description": {
          "type": "string",
          "description": "Description of the event."
        },
        "authorId": {
          "type": "string",
          "description": "The UID of the teacher who created the event."
        }
      },
      "required": [
        "id",
        "title",
        "date",
        "description",
        "authorId"
      ]
    },
    "ContactMessage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ContactMessage",
      "type": "object",
      "description": "Represents a contact message sent through the contact form.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the contact message."
        },
        "name": {
          "type": "string",
          "description": "Name of the person sending the message."
        },
        "email": {
          "type": "string",
          "description": "Email address of the person sending the message.",
          "format": "email"
        },
        "message": {
          "type": "string",
          "description": "Content of the contact message."
        },
        "sentDate": {
          "type": "string",
          "description": "Date the message was sent.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "email",
        "message",
        "sentDate"
      ]
    },
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user profile, linked to Firebase Authentication.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user, matching Firebase Auth UID."
        },
        "username": {
          "type": "string",
          "description": "The user's unique username."
        },
        "firstName": {
          "type": "string",
          "description": "First name of the user."
        },
        "lastName": {
          "type": "string",
          "description": "Last name of the user."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user, from Firebase Authentication.",
          "format": "email"
        },
        "role": {
          "type": "string",
          "description": "The role of the user.",
          "enum": [
            "student",
            "teacher"
          ]
        }
      },
      "required": [
        "id",
        "username",
        "firstName",
        "lastName",
        "email",
        "role"
      ]
    },
    "Resource": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Resource",
      "type": "object",
      "description": "Represents a downloadable resource.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the resource."
        },
        "name": {
          "type": "string",
          "description": "Name of the resource."
        },
        "fileUrl": {
          "type": "string",
          "description": "URL of the file stored in Firebase Storage.",
          "format": "uri"
        },
        "description": {
          "type": "string",
          "description": "Description of the resource."
        }
      },
      "required": [
        "id",
        "name",
        "fileUrl",
        "description"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/announcements/{announcementId}",
        "definition": {
          "entityName": "Announcement",
          "schema": {
            "$ref": "#/backend/entities/Announcement"
          },
          "description": "Stores school announcements.",
          "params": [
            {
              "name": "announcementId",
              "description": "Unique identifier for the announcement."
            }
          ]
        }
      },
      {
        "path": "/events/{eventId}",
        "definition": {
          "entityName": "Event",
          "schema": {
            "$ref": "#/backend/entities/Event"
          },
          "description": "Stores school events.",
          "params": [
            {
              "name": "eventId",
              "description": "Unique identifier for the event."
            }
          ]
        }
      },
      {
        "path": "/contactMessages/{contactMessageId}",
        "definition": {
          "entityName": "ContactMessage",
          "schema": {
            "$ref": "#/backend/entities/ContactMessage"
          },
          "description": "Stores contact messages sent through the contact form.",
          "params": [
            {
              "name": "contactMessageId",
              "description": "Unique identifier for the contact message."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profiles, linked to Firebase Authentication. 'userId' MUST match the Firebase Auth UID.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user, matching Firebase Auth UID."
            }
          ]
        }
      },
      {
        "path": "/resources/{resourceId}",
        "definition": {
          "entityName": "Resource",
          "schema": {
            "$ref": "#/backend/entities/Resource"
          },
          "description": "Stores downloadable resources.",
          "params": [
            {
              "name": "resourceId",
              "description": "Unique identifier for the resource."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to support SchoolPulse's features. User data is stored in `/users/{userId}` using Path-Based ownership. Announcements, Events, Contact Messages and Resources are stored in root collections. Segregating data into top-level collections simplifies querying and management. User data is kept separate, accessible based on role, ensuring privacy and security. The 'userId' parameter links Firebase Authentication with Firestore documents. The structure does not rely on any hierarchical authorization dependencies, ensuring atomic operations and ease of debugging."
  }
}
    